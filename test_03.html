<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/0.10.0/Tone.js"></script>
	<script>

	// Wrapping the SimpleSynth in a PolySynth
	// to enable multiple notes simultaneously.

	var Tone = window.Tone;
	
	var synth = new Tone.PolySynth(
		6, 
		Tone.SimpleSynth, {
			"oscillator" : {
				"partials" : [0, 2, 3, 4],
			}
		}
	);

	synth.toMaster();

	var pitches = ['A','Ab','B','Bb','C','D','Db','E','Eb','F','G','Gb'];

	var notes = [];
	for(var i=0; i < 10; i++){
		for(var p=0; p < pitches.length; p++){
			newNote = pitches[p] + String(i);
			notes.push(newNote);
		}
	}

	console.log(notes);

	// This is a substitute for FindNoteForInterval, which I'm not done writing
	// It counts up the giant array built with a loop
	// In the end, FindNoteForInterval should be able to calculate this
	// without a big premade array, and across any octave up or down
	function HackyCountUp(note,distance){
		var place = notes.indexOf(note);

		var pitch = note.substring(0, note.length - 1);
		var octave = Number(note.substring(note.length - 1));
		
		if(place === -1){
			console.log('ERROR: ' + note + ' does not exist in the note array.') 
		} else if(octave >= 9 || octave < 0) {
			// This isn't even a good out of bounds error catcher.
			// you could still get like, C8 distance 24 and go out of bounds without an error
			console.log('ERROR: ' + octave + ' is out of range of the hacky array.') 
		} else {
			console.log(note + ' + ' + distance + ' = ' + notes[place+distance]);
			return notes[place+distance];
		}
	}

	HackyCountUp("G3",10);

	// For a root note, find the corresponding note
	// of a given interval distance
	function FindNoteForInterval(note, distance){

		// TODO: confirm the validity of a note.
		//	 It should have at least 2 characters
		//	 The first character should be an uppercase letter ABCDEFG
		//	 The last character should be a positive number 0 - 9
		//	 Optional middle character should be one of b or #

		// Split the note into its two components, pitch and octave
		// eg Db3 is the pitch Db and the octave 3
		var pitch = note.substring(0, note.length - 1);
		var octave = note.substring(note.length - 1);

		// Divisible bit
		// First, calculate how many times we'll have to wrap
		wrapCount = Math.floor(distance/12);

		// Remainder bit
		modulo = distance % 12;

		// Note should be moved forward by modulo, and 
		// octave should be incremented by wrapCount

		// so it's index + modulo + wrap

		// so let's say G3 is the root, and 10 is the interval
		// G3+10 = Eb4;
		
		rootIndex = notes.indexOf("G3"); // potentially invalid i just made this syntax up

		// in this example case, rootIndex is 10 (out of 11)



		// Find the index of rootindex in the notes array
		// add modulo to that distance.

		// take octave and cast it as a number
		// add wrapCount to that number



		// combine the pitch and the octave into one string again
		// return that string

		// This fails because G3+10 will cause wrap 0. It will return Eb3 which is 2 down. 

		// There needs to be code that determines the note's place in the array, and compensates for it. That, or doesn't use it at all. 

		// Or maybe the index could be used in the calculation to start with?


		console.log(distance + ' wraps: ' + wrapCount);
		console.log('pitch: ' + pitch);
		console.log('octave: ' + octave);
	}

	// Play a note (required) for a duration (optional, in ms, defaults to 1s)
	function playNote(note, duration = 1000){
		synth.triggerAttack(note);

		setTimeout(function(){
			synth.triggerRelease(note);
		}, duration);
	}


	/*
	
	Treat the note provided (eg D#3) as a 0 index
	Count up through an array of all notes by the amounts listed

	The problem is actually constructing that array, or some kind
	of count function that eliminates the need for that array.



	*/

	/*
	
	Maj
	0 4 7

	Min
	0 3 7

	Dim
	0 3 6
	If C add 9

	Aug
	0 4 8
	if C add 10

	Sus2
	0 2 7

	Sus4
	0 5 7

	7Sus2
	0 2 7 10

	7Sus4
	0 5 7 10

	6
	0 4 7 9

	7
	0 4 7 10

	9
	0 4 7 14

	Maj7
	0 4 7 11

	Maj9
	0 4 7 11 14
	if C no 11?

	Maj11
	0 4 7 11 14 17
	if C no 11?

	Min6
	0 3 7 9

	Min7
	0 3 7 10

	Min9
	0 3 7 10 14

	Min 11
	0 3 7 10 14 17





	
	*/
	</script>
</head>
<body>
	<h2>skjdhf</h2>
</body>
</html>